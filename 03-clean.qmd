```{python}
import pandas as pd

status = pd.read_csv("data/station_status.csv")
info = pd.read_csv("data/station_info.csv")
```

Calculate average bikes available for a given station and time

```{python}
status['time_dt'] = pd.to_datetime(status['time'])
status['hour'] = status['time_dt'].dt.hour
status['date'] = status['time_dt'].dt.date
status['month'] = status['time_dt'].dt.month
status['dow'] =  status['time_dt'].dt.day_name()
```


```{python}
availibilty = status.groupby(['station_id', 'date', 'month', 'dow', 'hour']).agg({'num_bikes_available': 'mean'}).reset_index()
availibilty.head()
```

```{python}
bike_data = availibilty.merge(info, left_on='station_id', right_on='station_id')
bike_data.head()
```

```{python}
bike_data.info()
```

```{python}
bike_data.to_csv('data/bike_counts_by_time_location.csv', index=False)
```

